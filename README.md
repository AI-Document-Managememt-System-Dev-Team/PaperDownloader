# 知网/万方数据库批量下载

使用 selenium 自动化工具模拟用户下载。

**注意：本脚本不提供任何数据库下载账号，需要使用者自行准备。**

## 前提条件

- 使用 Google Chrome 浏览器
- 具备执行 python 代码的环境，包括 pip

## 使用方法

1. 下载本项目代码，有以下两种方法：

   - 使用 Git 克隆项目

     ```
     git clone https://github.com/jklincn/PaperDownloader.git
     ```

   - 在 GitHub 界面选择 Download ZIP，再解压

2. 安装依赖

   ```
   pip install selenium==4.11.2
   ```

3. 使用 prepare 参数运行脚本，将自动打开浏览器。用户**自行打开数据库网站登陆后**进行所需内容的检索，**在需要下载的论文前面打上勾**。

   ```
   python run.py prepare
   ```

4. 使用 download 参数运行脚本，即可开始下载，期间不要对浏览器进行操作。

   ```
   python run.py download
   ```

   所有下载完成后，终端会输出运行情况（成功下载数/已勾选数量）：

   ```
   INFO: Download completed, total number of papers: 20/20（根据实际情况变化）
   ```

## 参数配置

**默认情况下无需改动**

- ChromePath：Google Chrome 可执行文件路径。默认："C:\Program Files\Google\Chrome\Application\chrome.exe"。如果不是默认安装路径，则需要手动更改。
- Interval：下载间隔时间，单位为秒。默认：3。
- TempUserDateDir：临时用户数据存放目录。默认：当前目录下的 chrome_temp_data。如果不存在则会自动创建。可以使用 python run.py clean 清理目录。
- Port：浏览器调试模式端口。默认：16888。如果与本地已有服务冲突，可以自行更改。
- WaitTime：页面超时时间，单位为秒。默认：5。如果在使用知网数据库下载时，遇到错误检测登录状态的情况，请调大这个值。（这是由于下载页面加载超时导致）

## 兼容性测试

| 测试时间   | Python版本 | 浏览器版本                  | 测试操作                 |
| ---------- | ---------- | --------------------------- | ------------------------ |
| 2023-08-16 | 3.10.9     | Google Chrome 116.0.5845.97 | 知网间隔3秒批量下载20篇  |
| 2023-08-17 | 3.10.9     | Google Chrome 116.0.5845.97 | 知网、万方数据库同时下载 |

## 更新日志

2023-08-17：支持万方数据库，并且支持同时下载多个数据库，完善错误检查。

2023-08-16：第一版发布，使用谷歌浏览器批量下载知网论文。

## 未来工作

未来工作取决于大家的需求反馈，可以通过 issue 或者 email 来提出需求。

- [ ] 支持多种浏览器（Microsoft Edge、Mozilla Firefox等）
- [ ] 支持多类数据库（**万方（已支持）**、维普等）
- [ ] 方便使用的图形用户界面
- [ ] 支持使用默认用户数据文件（这样可以使用原已保存在浏览器中的账号密码，快速登录知网）
- [x] 更完善的操作错误检查提示
- [ ] 支持 CAJ 下载（当 PDF 不可用时）

## 已知问题

1. 问题：如果下载间隔过小，短时间下载次数过多，有可能引发知网反爬机制（需要输入验证码或者拖动图形等）。

   解决方法：增加间隔时间，分散下载操作。

2. 问题：使用脚本后，有可能会在桌面创建 Google Chrome 的快捷方式。

   解决方法：暂未查明创建原因，删除即可。

3. 问题：万方数据库下载等待时间为手动设置，可能会造成还没有开始下载但页面已关闭。

   解决方法：根据自身网速调大间隔时间。

## 联系方式

E-mail：jklincn@outlook.com

